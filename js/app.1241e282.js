(function(e){function t(t){for(var i,s,l=t[0],r=t[1],c=t[2],v=0,h=[];v<l.length;v++)s=l[v],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&h.push(a[s][0]),a[s]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);u&&u(t);while(h.length)h.shift()();return n.push.apply(n,c||[]),o()}function o(){for(var e,t=0;t<n.length;t++){for(var o=n[t],i=!0,l=1;l<o.length;l++){var r=o[l];0!==a[r]&&(i=!1)}i&&(n.splice(t--,1),e=s(s.s=o[0]))}return e}var i={},a={app:0},n=[];function s(t){if(i[t])return i[t].exports;var o=i[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=e,s.c=i,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(o,i,function(t){return e[t]}.bind(null,i));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=r;n.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"034f":function(e,t,o){"use strict";o("85ec")},"0782":function(e,t,o){"use strict";o("d8dd")},"0940":function(e,t,o){},"1daf":function(e,t,o){"use strict";o("38bd")},"1f33":function(e,t,o){"use strict";o("0940")},"38bd":function(e,t,o){},4589:function(e,t,o){},"56d7":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var i=o("2b0e"),a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container"},[o("Search"),o("router-view"),o("Footer")],1)},n=[],s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"search"},[o("h3",[e._v("MOVIEAPP")]),o("div",{staticClass:"type"},[o("router-link",{attrs:{to:"/"},nativeOn:{click:function(t){return e.show.apply(null,arguments)}}},[e._v("Movie")]),o("router-link",{attrs:{to:"/loveMovies"},nativeOn:{click:function(t){return e.show.apply(null,arguments)}}},[e._v("loves")])],1)])},l=[],r={name:"Search",methods:{show:function(){this.$store.commit("change",!1)}}},c=r,u=(o("0782"),o("2877")),v=Object(u["a"])(c,s,l,!1,null,null,null),h=v.exports,f=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("observer",{staticClass:"lazy",on:{"on-change":e.onChange}},[o("div",{staticClass:"footer"})])},d=[],m=o("544d"),p=o.n(m),g={components:{Observer:p.a},data:function(){return{page:1,mD:[]}},methods:{onChange:function(e,t){console.log("Footer被執行了"),console.log("see",e.isIntersecting),e.isIntersecting&&this.$store.dispatch("newFetch",[e,t])}}},b=g,_=(o("1f33"),Object(u["a"])(b,f,d,!1,null,null,null)),w=_.exports,D={components:{Search:h,Footer:w}},y=D,$=(o("034f"),Object(u["a"])(y,a,n,!1,null,null,null)),C=$.exports,k=o("8c4f"),S=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"top-movie"},[o("h2",{directives:[{name:"show",rawName:"v-show",value:!this.$store.state.showDetail,expression:"!this.$store.state.showDetail"}]},[e._v("熱門電影")]),o("div",{directives:[{name:"show",rawName:"v-show",value:!this.$store.state.showDetail,expression:"!this.$store.state.showDetail"}],staticClass:"movie-container"},e._l(this.$store.state.movieData,(function(t,i){return o("div",{key:i,staticClass:"movie",attrs:{id:t.id}},[o("observer",{staticClass:"lazy",on:{"on-change":e.onChange}},[o("div",{staticClass:"movie-img"},[o("img",{attrs:{"data-src":e.imgPath+t.poster_path},on:{click:function(o){return e.detail(t,o)}}}),o("div",{ref:t.id,refInFor:!0,staticClass:"love",on:{click:function(o){return e.loveCheck(t,o)}}},[e._v("❤")])])]),o("h1",[e._v(e._s(t.original_title))])],1)})),0)])},O=[],I=(o("caad"),o("2532"),o("4de4"),o("d3b7"),o("ac1f"),o("1276"),o("a9e3"),o("159b"),{components:{Observer:p.a},name:"movieList",data:function(){return{imgPath:"https://image.tmdb.org/t/p/w500",love:[]}},methods:{onChange:function(e,t){if(e.isIntersecting){var o=e.target,i=o.children[0].childNodes[0].getAttribute("data-src");o.children[0].childNodes[0].src=i,t(),console.log("該跑電影圖片了")}},detail:function(e,t){this.$store.commit("change",!0),this.$router.push({path:"/movieDetail",query:{id:e.id}})},loveCheck:function(e,t){this.love.includes(e.id)?(this.love=this.love.filter((function(t){return t!=e.id})),localStorage.setItem("love-movie",this.love),alert("從最愛移除"),console.log(this.love),t.target.className="love"):(this.love.push(e.id),localStorage.setItem("love-movie",this.love),alert("加入最愛"),console.log(this.love),t.target.className="love-active")}},created:function(){this.$store.dispatch("fetch")},mounted:function(){if(null!=localStorage.getItem("love-movie")){for(var e=localStorage.getItem("love-movie").split(","),t=0;t<e.length;t++)this.love.push(Number(e[t]));console.log(this.love)}},updated:function(){var e=this;this.$store.state.movieData.forEach((function(t){null!=localStorage.getItem("love-movie")&&localStorage.getItem("love-movie").includes(t.id)&&(e.$refs[t.id][0].className="love-active")}))},beforeDestroy:function(){console.log("電影列表死了",this.movieData)}}),j=I,M=(o("b1c7"),Object(u["a"])(j,S,O,!1,null,"f905aa24",null)),N=M.exports,x=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"love-movies"},[o("h2",{directives:[{name:"show",rawName:"v-show",value:!this.$store.state.showDetail,expression:"!this.$store.state.showDetail"}]},[e._v("電影收藏")]),o("div",{directives:[{name:"show",rawName:"v-show",value:!this.$store.state.showDetail,expression:"!this.$store.state.showDetail"}],staticClass:"love-movie-container"},e._l(e.movieInLocal,(function(t,i){return o("div",{key:i,staticClass:"love-movie",attrs:{id:t.id}},[o("div",{staticClass:"love-movie-img"},[o("img",{attrs:{src:e.imgPath+t.poster_path},on:{click:function(o){return e.detail(t,o)}}})]),o("h1",[e._v(e._s(t.original_title))])])})),0)])},P=[],E={name:"loveMovies",data:function(){return{movieInLocal:[],imgPath:"https://image.tmdb.org/t/p/w500"}},methods:{detail:function(e,t){this.$store.commit("change",!0),this.$router.push({path:"/movieDetail",query:{id:e.id}})}},created:function(){var e=this;fetch("https://api.themoviedb.org/3/movie/popular?api_key=e147528034b3b1192f389af6460b3ad9&language=zh-TW&page=1").then((function(e){return e.json()})).then((function(t){console.log(localStorage.getItem("love-movie")),t.results.forEach((function(t){localStorage.getItem("love-movie").includes(t.id)&&e.movieInLocal.push(t)})),console.log(e.movieInLocal)}))}},L=E,T=(o("1daf"),Object(u["a"])(L,x,P,!1,null,"41617e18",null)),F=T.exports,z=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"box"},[o("div",{staticClass:"detail"},[o("div",{staticClass:"pic"},[o("img",{attrs:{src:e.imgPath+e.detailData.poster_path}}),o("div",{ref:"love",staticClass:"love",on:{click:function(t){return e.loveCheck(e.detailData.id,t)}}},[e._v(" ❤ ")])]),o("div",{staticClass:"content"},[o("div",{attrs:{id:"title"}},[o("h1",[e._v(e._s(e.detailData.title))]),o("h5",[e._v(e._s(e.detailData.tagline))])]),o("div",{attrs:{id:"info"}},[o("h4",[e._v("vote:"+e._s(e.detailData.vote_average)+"point")]),o("h4",[e._v("time:"+e._s(e.detailData.runtime)+"min")]),e._l(e.detailData.genres,(function(t,i){return o("h4",{key:i},[e._v(" "+e._s(t.name)+" ")])}))],2),o("div",{attrs:{id:"outline"}},[o("h4",[e._v("outLine:")]),o("h4",[e._v(e._s(e.detailData.overview))])]),o("div",{staticClass:"back"},[o("button",{on:{click:e.backToList}},[e._v("Back to Movies")])])])])])},q=[],W={name:"movieDetail",data:function(){return{detailData:[],imgPath:"https://image.tmdb.org/t/p/w500",love:[]}},methods:{backToList:function(){this.$router.back(),this.$store.commit("change",!1)},popstate:function(){this.$store.commit("change",!1)},loveCheck:function(e,t){this.love.includes(e)?(this.love=this.love.filter((function(t){return t!=e})),localStorage.setItem("love-movie",this.love),alert("從最愛移除"),t.target.className="love",console.log(this.love,t.target)):(this.love.push(e),localStorage.setItem("love-movie",this.love),alert("加入最愛"),t.target.className="love-active",console.log(this.love,t.target))}},created:function(){var e=this;fetch("https://api.themoviedb.org/3/movie/"+this.$route.query.id+"?api_key=e147528034b3b1192f389af6460b3ad9&language=en-US").then((function(e){return e.json()})).then((function(t){e.detailData=t,console.log("電影Detail來了",t),console.log(e.$refs);for(var o=localStorage.getItem("love-movie").split(","),i=0;i<o.length;i++)e.love.push(Number(o[i])),e.detailData.id==Number(o[i])?e.$refs.love.className="love-active":e.$refs.love.className="love"}))},mounted:function(){window.addEventListener("popstate",this.popstate)},beforeDestroy:function(){console.log("電影Detail要死了")}},A=W,J=(o("79e3"),Object(u["a"])(A,z,q,!1,null,null,null)),B=J.exports,U=new k["a"]({routes:[{path:"/",component:N},{path:"/movieDetail",component:B},{path:"/loveMovies",component:F}]}),V=(o("25f0"),o("2f62"));i["a"].use(V["a"]);var G={fetch:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){fetch("https://api.themoviedb.org/3/movie/popular?api_key=e147528034b3b1192f389af6460b3ad9&language=zh-TW&page=1").then((function(e){return e.json()})).then((function(t){t.results=t.results.filter((function(e){return null!=e.poster_path})),e.state.movieData=t.results,console.log("電影列表來了",e.state.movieData)}))})),newFetch:function(e,t){e.state.page++,1==e.state.page?console.log("先不要"):fetch("https://api.themoviedb.org/3/movie/popular?api_key=e147528034b3b1192f389af6460b3ad9&language=zh-TW&page="+e.state.page).then((function(e){return e.json()})).then((function(t){t.results.forEach((function(t){e.state.movieData.push(t)})),console.log("新電影進來了")}))},addLoveMovie:function(e,t){console.log(e,t),1==e.state.loveMovie.includes(t[0])?(t[1].target.className="love",alert("從最愛移除"),e.state.loveMovie=e.state.loveMovie.filter((function(e){return e!=t[0]})),console.log(e.state.loveMovie)):(t[1].target.className="love-active",alert("已加入最愛"),e.state.loveMovie.push(t[0]),console.log(e.state.loveMovie))}},H={change:function(e,t){e.showDetail=t}},K={showDetail:!1,movieData:[],page:0,loveMovie:[]},Q=new V["a"].Store({actions:G,mutations:H,state:K});i["a"].config.productionTip=!1,i["a"].use(k["a"]),new i["a"]({render:function(e){return e(C)},router:U,store:Q}).$mount("#app")},"79e3":function(e,t,o){"use strict";o("4589")},"85ec":function(e,t,o){},b1c7:function(e,t,o){"use strict";o("d082")},d082:function(e,t,o){},d8dd:function(e,t,o){}});
//# sourceMappingURL=app.1241e282.js.map